I"V<h2 id="exercise">Exercise</h2>

<blockquote>
  <p>Happiness:)
Download</p>
</blockquote>

<p><img src="/assets/images/2018-02-06-Codegate-CTF-RedVelvet-75/exercise.png" alt="" /></p>
<p align="center"><i>[ê·¸ë¦¼] exercise</i></p>

<h2 id="solution1---z3-solver">Solution1 - z3 Solver</h2>

<p>ì¼ë³¸ì—ì„œ 1ë‹¬ê°„ ì§„í–‰í–ˆë˜ ì‚°í•™ì—°ìˆ˜ë¥¼ ë§ˆë¬´ë¦¬í•˜ê³  ê·€êµ­í•˜ëŠ” ë‚ ì´ë¼ ì •ì‹ ì´ ì—†ì–´, íŒ€ì›ë“¤ì—ê²Œ ì°¸ê°€ìœ¨ì´ ë§¤ìš° ë‚®ì„ ìˆ˜ ìˆë‹¤ê³  ë¯¸ë¦¬ ì–˜ê¸°í–ˆì—ˆë‹¤. ê·€êµ­í•˜ê³  ì ê¹ Droid ë¬¸ì œ ë³¸ ê²ƒ ì™¸ì—” ì œëŒ€ë¡œ ë¬¸ì œë„ ë³´ì§€ ëª»í•˜ê³  íì§€ë¶€ì§€ ë„˜ì–´ê°”ë˜ <code class="highlighter-rouge">2018 codegate</code> ã… â€¦</p>

<p>ì´ ë¬¸ì œëŠ” ê°™ì€ íŒ€ì› ì¤‘ í•œëª…ì´ ì´ë¯¸ í’€ì—ˆë˜ ë¬¸ì œì´ë‹¤. z3ë¥¼ ì´ìš©í•´ì„œ í•´ê²°í•  ìˆ˜ ìˆì—ˆëŠ” ë¬¸ì œì¸ë°, z3 ì‚¬ìš© ì™¸ì—ë„ Angrë¥¼ ì´ìš©í•´ì„œë„ í•´ê²° í•  ìˆ˜ ìˆëŠ” ë¬¸ì œì´ê¸°ì— í’€ ìˆ˜ ìˆëŠ” ë°©ì‹ì„ ì­‰ ì •ë¦¬í•´ë³´ë ¤ í•œë‹¤.</p>

<p>binary ì •ë³´ë¥¼ í™•ì¸í•´ë³´ë©´, ì•„ë˜ì™€ ê°™ì´ 64bit ELF íŒŒì¼ì´ë‹¤.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> jsh05042@Macs-MacBook-Pro î‚° ~/Desktop/CTF/2018_Codegate_CTF/reversing/RedVelvetî‚°
î‚° file ./RedVelvet
./RedVelvet: ELF 64-bit LSB executable, x86-64, version 1 <span class="o">(</span>SYSV<span class="o">)</span>, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, <span class="k">for </span>GNU/Linux 2.6.32, BuildID[sha1]<span class="o">=</span>84e7ef91c33878cf9eefc00a7a450895aa573494, not stripped
</code></pre></div></div>

<p>ì‹¤í–‰í•´ë³´ë©´, ì•„ë˜ì™€ ê°™ì´ input ì„ ë°›ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆëŠ”ë° ë³„ë‹¤ë¥¸ incorrect message ì—†ì´ ê·¸ëŒ€ë¡œ binary ê°€ ì¢…ë£Œ ëœë‹¤.
<img src="/assets/images/2018-02-06-Codegate-CTF-RedVelvet-75/run.png" alt="" /></p>
<p align="center"><i>[ê·¸ë¦¼] run</i></p>

<p>ë°”ë¡œ, IDA ë¡œ binary ë¶„ì„ì„ í•´ë³´ë©´ ì •ìƒì ìœ¼ë¡œ decompile ë˜ë©°, ì•„ë˜ì™€ ê°™ì€ êµ¬ì¡°ë¡œ ì´ë¤„ì§„ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>
<pre><code class="language-C">int __cdecl main(int argc, const char **argv, const char **envp)
{
  char v3; // bl@0
  __int64 v4; // rax@1
  __int64 v5; // rcx@1
  size_t v6; // rax@2
  char v8; // t1@8
  bool v9; // zf@8
  signed int i; // [sp+8h] [bp-1B8h]@2
  char v11; // [sp+50h] [bp-170h]@2
  char s; // [sp+C0h] [bp-100h]@1
  char v13; // [sp+C1h] [bp-FFh]@1
  char v14; // [sp+C2h] [bp-FEh]@1
  char v15; // [sp+C3h] [bp-FDh]@1
  char v16; // [sp+C4h] [bp-FCh]@1
  char v17; // [sp+C5h] [bp-FBh]@1
  char v18; // [sp+C6h] [bp-FAh]@1
  char v19; // [sp+C7h] [bp-F9h]@1
  char v20; // [sp+C8h] [bp-F8h]@1
  char v21; // [sp+C9h] [bp-F7h]@1
  char v22; // [sp+CAh] [bp-F6h]@1
  char v23; // [sp+CBh] [bp-F5h]@1
  char v24; // [sp+CCh] [bp-F4h]@1
  char v25; // [sp+CDh] [bp-F3h]@1
  char v26; // [sp+CEh] [bp-F2h]@2
  char v27; // [sp+CFh] [bp-F1h]@2
  char v28; // [sp+D0h] [bp-F0h]@2
  char v29; // [sp+D1h] [bp-EFh]@2
  char v30; // [sp+D2h] [bp-EEh]@2
  char v31; // [sp+D3h] [bp-EDh]@2
  char v32; // [sp+D4h] [bp-ECh]@2
  char v33; // [sp+D5h] [bp-EBh]@2
  char v34; // [sp+D6h] [bp-EAh]@2
  char v35; // [sp+D7h] [bp-E9h]@2
  char v36; // [sp+D8h] [bp-E8h]@2
  char v37; // [sp+D9h] [bp-E7h]@2
  char v38[32]; // [sp+E0h] [bp-E0h]@2
  char s1[80]; // [sp+100h] [bp-C0h]@3
  char s2[8]; // [sp+150h] [bp-70h]@1
  __int64 v41; // [sp+158h] [bp-68h]@1
  __int64 v42; // [sp+160h] [bp-60h]@1
  __int64 v43; // [sp+168h] [bp-58h]@1
  __int64 v44; // [sp+170h] [bp-50h]@1
  __int64 v45; // [sp+178h] [bp-48h]@1
  __int64 v46; // [sp+180h] [bp-40h]@1
  __int64 v47; // [sp+188h] [bp-38h]@1
  __int64 v48; // [sp+190h] [bp-30h]@1
  __int64 v49; // [sp+198h] [bp-28h]@1
  __int64 v50; // [sp+1A0h] [bp-20h]@1
  __int64 v51; // [sp+1A8h] [bp-18h]@1
  int v52; // [sp+1B0h] [bp-10h]@1
  __int64 v53; // [sp+1B8h] [bp-8h]@1

  v53 = *MK_FP(__FS__, 40LL);
  *(_QWORD *)s2 = 3905859155515433264LL;
  v41 = 3990529441497888818LL;
  v42 = 7017565014431380534LL;
  v43 = 3977633058323522358LL;
  v44 = 7364290724313116725LL;
  v45 = 3991705742141175652LL;
  v46 = 7363494672811320633LL;
  v47 = 3847534474596595814LL;
  v48 = 0LL;
  v49 = 0LL;
  v50 = 0LL;
  v51 = 0LL;
  v52 = 0;
  printf((const char *)&amp;loc_4016CF + 1, argv, envp);
  fgets(&amp;s, 27, edata);
  func1((unsigned int)s, (unsigned int)v13);
  func2((unsigned int)v13, (unsigned int)v14);
  func3((unsigned int)v14, (unsigned int)v15);
  func4((unsigned int)v15, (unsigned int)v16);
  func5((unsigned int)v16, (unsigned int)v17);
  func6((unsigned int)v17, (unsigned int)v18, (unsigned int)v19);
  func7((unsigned int)v19, (unsigned int)v20, (unsigned int)v21);
  func8((unsigned int)v21, (unsigned int)v22, (unsigned int)v23);
  func9((unsigned int)v23, (unsigned int)v24, (unsigned int)v25);
  v4 = ptrace(0, 0LL, 1LL, 0LL);
  if ( v4 == -1 )
  {
    v8 = *(_BYTE *)v5;
    v9 = v3 + *(_BYTE *)(v5 + 111) == 0;
    *(_BYTE *)(v5 + 111) += v3;
    JUMPOUT(!v9, &amp;unk_401746);
    v6C &amp;= BYTE1(v4);
    JUMPOUT(*(_QWORD *)"ag : ");
  }
  func10((unsigned int)v25, (unsigned int)v26, (unsigned int)v27);
  func11((unsigned int)v27, (unsigned int)v28, (unsigned int)v29);
  func12((unsigned int)v29, (unsigned int)v30, (unsigned int)v31);
  func13((unsigned int)v31, (unsigned int)v32, (unsigned int)v33);
  func14((unsigned int)v33, (unsigned int)v34, (unsigned int)v35);
  func15((unsigned int)v35, (unsigned int)v36, (unsigned int)v37);
  SHA256_Init(&amp;v11);
  v6 = strlen(&amp;s);
  SHA256_Update(&amp;v11, &amp;s, v6);
  SHA256_Final(v38, &amp;v11);
  for ( i = 0; i &lt;= 31; ++i )
    sprintf(&amp;s1[2 * i], "%02x", (unsigned __int8)v38[i]);
  if ( strcmp(s1, s2) )
    exit(1);
  printf("flag : {\" %s \"}\n", &amp;s);
  return 0;
}
</code></pre>

<blockquote>
  <p>ìœ„ decompile codeë¥¼ ë³´ê³  ì•Œ ìˆ˜ ìˆëŠ” ì‚¬ì‹¤ì€ 27ê°œì˜ ë¬¸ìì—´ì„ fgetsë¡œ ì…ë ¥ ë°›ìœ¼ë©°, func í•¨ìˆ˜ë“¤ì„ í†µí•´ ì¼ë ¨ëœ ì‘ì—…ì„ ê±°ì¹œ ë’¤, SHA256 ë¹„êµë¥¼ ì§„í–‰í•˜ê³ , flagë¥¼ ì¶œë ¥í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>
</blockquote>

<p>ì´ 15ê°œì˜ funcì´ ì¡´ì¬í•˜ë©°, ê°ê°ì˜ funcì—ëŠ” ì•„ë˜ì™€ ê°™ì´ ì¸ì ê°’ì— ëŒ€í•œ ë¹„êµ ì—°ì‚°ì„ ìˆ˜í–‰í•œë‹¤. ë¹„êµ ì—°ì‚° ê²°ê³¼ê°€ í†µê³¼ë  ê²½ìš° <code class="highlighter-rouge">HAPPINESS:)</code>ë¼ëŠ” ë¬¸ìì—´ì„ ì¶œë ¥í•˜ë©°, ì•„ë‹ ê²½ìš° ë°”ë¡œ binaryë¥¼ ì¢…ë£Œí•œë‹¤.</p>

<pre><code class="language-C">int __fastcall func1(char a1, char a2)
{
  if ( a1 * 2 * (char)(a2 ^ a1) - a2 != 10858 )
    exit(1);
  if ( a1 &lt;= 85 || a1 &gt; 95 || a2 &lt;= 96 || a2 &gt; 111 )
    exit(1);
  return puts("HAPPINESS:)");
}
</code></pre>

<p>ìœ„ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë“¯ì´, ê°ê°ì˜ funcë“¤ì€ ì¼ë ¨ëœ ì—°ì‚° ì‘ì—…ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆëŠ”ë° ì´ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ <code class="highlighter-rouge">z3</code>ë¥¼ ì´ìš©í•  ìˆ˜ ìˆë‹¤. ê°ê°ì˜ funcì— ë“¤ì–´ê°€ëŠ” ì¸ì ê°’ë“¤ì„ ë¬¸ìì—´ ë°°ì—´ ë³€ìˆ˜ë¡œ ë‘ê³ , í•´ë‹¹ ë³€ìˆ˜ë“¤ì— ëŒ€í•´ì„œ z3 ì¡°ê±´ë¬¸ì„ ê·¸ëŒ€ë¡œ ì¶©ì¡± ì‹œì¼œì¤€ë‹¤.</p>

<p>ì´ a1~a27 ê¹Œì§€ 27ê°œì˜ ë³€ìˆ˜ê°€ í•„ìš”í•˜ë‹¤. <code class="highlighter-rouge">z3</code> ì—ì„œ ì—°ì‚°ì„ ìœ„í•œ ê° ë³€ìˆ˜ë¥¼ ì„ ì–¸í•œë‹¤. ì•„ë˜ëŠ” ìœ„ <code class="highlighter-rouge">RedVelvet</code> binaryì˜ ì—°ì‚°ì„ <code class="highlighter-rouge">z3</code> ìˆ˜ì‹ìœ¼ë¡œ ë³€í™˜í•œ ë‚´ìš©ì´ë‹¤. ê¿€íŒ?ì´ë¼ê¸°ë³´ë‹¨, ì¢€ ë” í¸í•œ model ë§Œë“œëŠ” ë°©ì‹ì´ ìˆëŠ”ë°, ëŒ€ë¶€ë¶„ IDA ì—ì„œ Hex-Rayë¡œ Decompileëœ Codeì—ì„œ ë³µì¡í•œ ìˆ˜ì‹ì„ <code class="highlighter-rouge">z3</code>ì‹ìœ¼ë¡œ ì˜®ê¸¸ ë•Œ, <code class="highlighter-rouge">a1 * 2 * (a2 ^ a1) - a2 != 0x2A6A</code>ë¼ëŠ” ì‹ì´ ìˆìœ¼ë©´, s.add(<code class="highlighter-rouge">a1 * 2 * (a2 ^ a1) - a2 == 0x2A6A</code>)ì™€ ê°™ì€ í˜•íƒœë¡œ ì¡°ê±´ ì‹ì„ ë°˜ëŒ€ë¡œ ë³€í™˜í•´ì„œ ì‘ì„±í•œë‹¤.</p>

<p>ì¦‰, ë³¸ ë¬¸ì œì—ì„œëŠ” <code class="highlighter-rouge">a1 * 2 * (a2 ^ a1) - a2 != 0x2A6A</code> ë¼ëŠ” ì‹ì— ì°¸ì´ ë  ê²½ìš° <code class="highlighter-rouge">exit</code>ë¡œ ë¹ ì§€ê¸° ë•Œë¬¸ì— í•´ë‹¹ ì¡°ê±´ì— ë§ì§€ ì•ŠëŠ” ê°’ì„ ì°¾ì•„ë‚´ì•¼í•˜ëŠ” ê²ƒì´ë‹¤. ì´ ë•Œ, í•´ë‹¹ ì¡°ê±´ì— ë§ì§€ ì•ŠëŠ” ê°’ì„ ì°¾ê¸° ìœ„í•´ì„œ ë¹„êµ ì—°ì‚°ìë¥¼ ë°˜ëŒ€ë¡œ ì„¤ì •í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ë‹¤. í•˜ì§€ë§Œ, ê·¸ëŸ´ í•„ìš” ì—†ì´ IDA ì—ì„œ ìˆ˜ì‹ì„ ìŠ¥ ê¸ì–´ì™€ <code class="highlighter-rouge">Not()</code>ìœ¼ë¡œ ê°ì‹¸ì£¼ê¸°ë§Œ í•˜ë©´ ê·¸ëŒ€ë¡œ ì ìš©ëœë‹¤. &gt;, &lt; ê°™ì€ ë¶€ë“±í˜¸ ì—°ì‚°ì„ ì˜®ê¸¸ ë•Œ, íŠ¹íˆ &lt;= ë“±ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ê³¼ì •ì—ì„œ ì¢…ì¢… ì‹¤ìˆ˜í•  ìˆ˜ ìˆëŠ”ë° í¸í•˜ê²Œ <code class="highlighter-rouge">Not()</code>ì„ ì ìš© ì‹œí‚¤ë©´ ë³¸ë˜ì˜ ìˆ˜ì‹ì„ ê·¸ëŒ€ë¡œ ì ìš©í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— êµ³ì´ ë°”ê¿€ í•„ìš”ê°€ ì—†ë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">z3</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">Solver</span><span class="p">()</span>

<span class="c1">#array = [ BitVec('a%i'%i,32) for i in range(1,27)]
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">27</span><span class="p">):</span>
    <span class="nb">globals</span><span class="p">()[</span><span class="s">'a%i'</span><span class="o">%</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">BitVec</span><span class="p">(</span><span class="s">'a%i'</span><span class="o">%</span><span class="n">i</span><span class="p">,</span><span class="mi">32</span><span class="p">)</span>

<span class="c1">#func1 a1, a2
</span><span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a1</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">a2</span> <span class="o">^</span> <span class="n">a1</span><span class="p">)</span> <span class="o">-</span> <span class="n">a2</span> <span class="o">!=</span> <span class="mh">0x2A6A</span> <span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a1</span> <span class="o">&lt;=</span> <span class="mh">0x55</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a1</span> <span class="o">&gt;</span> <span class="mh">0x5F</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a2</span> <span class="o">&lt;=</span> <span class="mh">0x60</span> <span class="p">,</span><span class="n">a2</span> <span class="o">&gt;</span> <span class="mh">0x6F</span><span class="p">))</span>


<span class="c1">#func2 a2, a3
</span><span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a2</span> <span class="o">%</span> <span class="n">a3</span> <span class="o">!=</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a3</span> <span class="o">&lt;=</span> <span class="mh">0x5A</span><span class="p">))</span>


<span class="c1">#func3 a3, a4
</span><span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a3</span> <span class="o">/</span> <span class="n">a4</span> <span class="o">+</span> <span class="p">(</span><span class="n">a4</span> <span class="o">^</span> <span class="n">a3</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">21</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a3</span> <span class="o">&gt;</span> <span class="mi">99</span><span class="p">,</span> <span class="n">a4</span> <span class="o">&gt;</span> <span class="mi">119</span><span class="p">))</span>


<span class="c1">#func4 a4, a5
</span><span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a4</span> <span class="o">&lt;=</span> <span class="mi">115</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a5</span> <span class="o">!=</span> <span class="mi">95</span><span class="p">))</span>

<span class="c1">#func5 a5, a6
</span><span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">((</span><span class="n">a6</span> <span class="o">+</span> <span class="n">a5</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">a5</span> <span class="o">^</span> <span class="n">a6</span> <span class="o">^</span> <span class="n">a5</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">225</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span> <span class="n">a5</span> <span class="o">&lt;=</span> <span class="mi">90</span><span class="p">,</span> <span class="n">a6</span> <span class="o">&gt;</span> <span class="mi">89</span><span class="p">))</span>


<span class="c1">#func6 a6, a7, a8
</span><span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a6</span> <span class="o">&gt;</span> <span class="n">a7</span><span class="p">,</span> <span class="n">a7</span> <span class="o">&gt;</span> <span class="n">a8</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a6</span> <span class="o">&lt;=</span> <span class="mi">85</span><span class="p">,</span> <span class="n">a7</span> <span class="o">&lt;=</span> <span class="mi">110</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a8</span> <span class="o">&lt;=</span> <span class="mi">115</span><span class="p">,</span> <span class="p">((</span><span class="n">a7</span> <span class="o">+</span> <span class="n">a8</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">a6</span> <span class="o">+</span> <span class="n">a7</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">44</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">((</span><span class="n">a7</span> <span class="o">+</span> <span class="n">a8</span><span class="p">)</span> <span class="o">%</span> <span class="n">a6</span> <span class="o">+</span> <span class="n">a7</span> <span class="o">!=</span> <span class="mi">161</span><span class="p">))</span>


<span class="c1">#func7 a8, a9, a10
</span><span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a8</span> <span class="o">&lt;</span> <span class="n">a9</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a9</span> <span class="o">&lt;</span> <span class="n">a10</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a8</span> <span class="o">&gt;</span> <span class="mi">119</span><span class="p">,</span> <span class="n">a9</span> <span class="o">&lt;=</span> <span class="mi">90</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a10</span> <span class="o">&gt;</span> <span class="mi">89</span><span class="p">,((</span><span class="n">a8</span> <span class="o">+</span> <span class="n">a10</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">a9</span> <span class="o">+</span> <span class="n">a10</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">122</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">((</span><span class="n">a8</span> <span class="o">+</span> <span class="n">a10</span><span class="p">)</span> <span class="o">%</span> <span class="n">a9</span> <span class="o">+</span> <span class="n">a10</span> <span class="o">!=</span> <span class="mi">101</span><span class="p">))</span>


<span class="c1">#func8 a10, a11, a12
</span><span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a10</span> <span class="o">&gt;</span> <span class="n">a11</span><span class="p">,</span> <span class="n">a11</span> <span class="o">&gt;</span> <span class="n">a12</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a12</span> <span class="o">&gt;</span> <span class="mi">114</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">((</span><span class="n">a10</span> <span class="o">+</span> <span class="n">a11</span><span class="p">)</span> <span class="o">/</span> <span class="n">a12</span> <span class="o">*</span> <span class="n">a11</span> <span class="o">!=</span> <span class="mi">97</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">((</span><span class="n">a12</span> <span class="o">^</span> <span class="p">(</span><span class="n">a10</span> <span class="o">-</span> <span class="n">a11</span><span class="p">))</span> <span class="o">*</span> <span class="n">a11</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">10088</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a12</span> <span class="o">&gt;</span> <span class="mi">114</span><span class="p">))</span>

<span class="c1">#func9 a12, a13, a14
</span><span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a12</span> <span class="o">!=</span> <span class="n">a13</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a13</span> <span class="o">&lt;</span> <span class="n">a14</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a14</span> <span class="o">&gt;</span> <span class="mi">99</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a14</span> <span class="o">+</span> <span class="n">a12</span> <span class="o">*</span> <span class="p">(</span><span class="n">a14</span> <span class="o">-</span> <span class="n">a13</span><span class="p">)</span> <span class="o">-</span> <span class="n">a12</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1443</span> <span class="p">))</span>


<span class="c1">#func10 a14, a15, a16
</span><span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a14</span> <span class="o">&lt;</span> <span class="n">a15</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a15</span> <span class="o">&lt;</span> <span class="n">a16</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a15</span> <span class="o">*</span> <span class="p">(</span><span class="n">a14</span> <span class="o">+</span> <span class="n">a16</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">a16</span> <span class="o">!=</span> <span class="mi">15514</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a15</span> <span class="o">&lt;=</span> <span class="mi">90</span><span class="p">,</span> <span class="n">a15</span> <span class="o">&gt;</span> <span class="mi">99</span><span class="p">))</span>


<span class="c1">#func11 a16, a17, a18
</span><span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a17</span> <span class="o">&lt;</span> <span class="n">a16</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a16</span> <span class="o">&lt;</span> <span class="n">a18</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a17</span> <span class="o">&lt;=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">a17</span> <span class="o">&gt;</span> <span class="mi">104</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">((</span><span class="n">a16</span> <span class="o">+</span> <span class="p">(</span><span class="n">a17</span> <span class="o">^</span> <span class="p">(</span><span class="n">a17</span> <span class="o">-</span> <span class="n">a18</span><span class="p">)))</span> <span class="o">-</span> <span class="n">a18</span> <span class="o">!=</span> <span class="mi">70</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">((</span><span class="n">a17</span> <span class="o">+</span> <span class="n">a18</span><span class="p">)</span> <span class="o">/</span> <span class="n">a16</span> <span class="o">+</span> <span class="n">a16</span> <span class="o">!=</span> <span class="mi">68</span><span class="p">))</span>


<span class="c1">#func12 a18, a19, a20
</span><span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a18</span> <span class="o">&lt;</span> <span class="n">a19</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a19</span> <span class="o">&lt;</span> <span class="n">a20</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a19</span> <span class="o">&gt;</span> <span class="mi">59</span><span class="p">,</span> <span class="n">a20</span> <span class="o">&gt;</span> <span class="mi">44</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a18</span> <span class="o">+</span> <span class="p">(</span><span class="n">a19</span> <span class="o">^</span> <span class="p">(</span><span class="n">a20</span> <span class="o">+</span> <span class="n">a19</span><span class="p">))</span> <span class="o">-</span> <span class="n">a20</span> <span class="o">!=</span> <span class="mi">111</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">((</span><span class="n">a19</span> <span class="o">^</span> <span class="p">(</span><span class="n">a19</span> <span class="o">-</span> <span class="n">a20</span><span class="p">))</span> <span class="o">+</span> <span class="n">a19</span> <span class="o">!=</span> <span class="mi">101</span> <span class="p">))</span>


<span class="c1">#func13 a20, a21, a22
</span><span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a20</span> <span class="o">&gt;</span> <span class="n">a21</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a21</span> <span class="o">&gt;</span> <span class="n">a22</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a20</span> <span class="o">&lt;=</span> <span class="mi">40</span><span class="p">,</span> <span class="n">a21</span> <span class="o">&lt;=</span> <span class="mi">90</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a22</span> <span class="o">&gt;</span> <span class="mi">109</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">((</span><span class="n">a22</span> <span class="o">+</span> <span class="p">(</span><span class="n">a21</span> <span class="o">^</span> <span class="p">(</span><span class="n">a22</span> <span class="o">+</span> <span class="n">a20</span><span class="p">))</span> <span class="o">-</span> <span class="n">a20</span> <span class="o">!=</span> <span class="mi">269</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">((</span><span class="n">a22</span> <span class="o">^</span> <span class="p">(</span><span class="n">a21</span> <span class="o">-</span> <span class="n">a20</span><span class="p">))</span> <span class="o">+</span> <span class="n">a21</span> <span class="o">!=</span> <span class="mi">185</span><span class="p">))</span>


<span class="c1">#func14 a22, a23, a24
</span><span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a22</span> <span class="o">&lt;</span> <span class="n">a23</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a23</span> <span class="o">&lt;</span> <span class="n">a24</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a23</span> <span class="o">&gt;</span> <span class="mi">99</span><span class="p">,</span> <span class="n">a24</span> <span class="o">&lt;=</span> <span class="mi">90</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a22</span> <span class="o">+</span> <span class="p">(</span><span class="n">a23</span> <span class="o">^</span> <span class="p">(</span><span class="n">a23</span> <span class="o">+</span> <span class="n">a22</span><span class="p">))</span> <span class="o">-</span> <span class="n">a24</span> <span class="o">!=</span> <span class="mi">185</span><span class="p">))</span>


<span class="c1">#func15 a24, a25, a26
</span><span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a25</span> <span class="o">&lt;</span> <span class="n">a26</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a25</span> <span class="o">&lt;</span> <span class="n">a24</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(</span><span class="n">a26</span> <span class="o">&lt;=</span> <span class="mi">95</span><span class="p">,</span> <span class="n">a25</span> <span class="o">&gt;</span> <span class="mi">109</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(((</span><span class="n">a25</span> <span class="o">-</span> <span class="n">a24</span><span class="p">)</span> <span class="o">*</span> <span class="n">a25</span> <span class="o">^</span> <span class="n">a26</span><span class="p">)</span> <span class="o">-</span> <span class="n">a24</span> <span class="o">!=</span> <span class="mi">1214</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Not</span><span class="p">(((</span><span class="n">a26</span> <span class="o">-</span> <span class="n">a25</span><span class="p">)</span> <span class="o">*</span> <span class="n">a26</span> <span class="o">^</span> <span class="n">a24</span><span class="p">)</span> <span class="o">+</span> <span class="n">a25</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1034</span><span class="p">))</span>


<span class="k">print</span> <span class="s">"[+]"</span><span class="p">,</span><span class="n">s</span><span class="p">.</span><span class="n">check</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">model</span><span class="p">()</span>

<span class="n">flag</span><span class="o">=</span><span class="s">""</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">27</span><span class="p">):</span>
    <span class="n">strVar</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()[</span><span class="s">'a%i'</span> <span class="o">%</span> <span class="n">i</span><span class="p">]</span>
    <span class="n">char</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">strVar</span><span class="p">].</span><span class="n">as_long</span><span class="p">()</span>
    <span class="n">flag</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
<span class="k">print</span> <span class="n">flag</span>
</code></pre></div></div>

<p>ìœ„ z3 codeë¥¼ ëŒë¦¬ë©´, flagë¥¼ í™•ì¸í•  ìˆ˜ ìˆëŠ”ë° hash value ê°€ ë§ì§€ ì•Šì•„ ì •ìƒì ìœ¼ë¡œ ì¸ì¦í•  ìˆ˜ ì—†ë‹¤. ìì„¸íˆ ì‚´í´ë³´ë©´, ` ë¬¸ìì—´ì´ ìˆëŠ”ê±¸ ë³¼ ìˆ˜ ìˆëŠ”ë° ì´ì–´ì„œ ë‚˜ì˜¤ëŠ” ë¬¸ìê°€ â€˜laâ€™ì¸ ê²ƒì„ ë³´ê³  ì ì ˆíˆ ë°”ê¿”ì£¼ì—ˆë”ë‹ˆ ì •ë‹µì„ì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤. Symbolic ìì²´ê°€ ì¡°ê±´ì— ë¶€í•©í•˜ëŠ” ë‹¤ë¥¸ ê°’ì´ ì¡´ì¬í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë°œìƒí•œ ë¬¸ì œì¸ ê²ƒ ê°™ë‹¤.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> jsh05042@Macs-MacBook-Pro î‚° ~/Desktop/CTF/2018_Codegate_CTF/ë¬¸ì œë°±ì—…/[Rev]RedVelvetî‚°
î‚°python ./solver.py
<span class="o">[</span>+] sat
What_You_Wanna_By?:<span class="o">)</span><span class="p">;</span>l<span class="sb">`</span>_la
</code></pre></div></div>

<p><br /></p>
<h2 id="solution2---angr-script">Solution2 - Angr Script</h2>

<ul>
  <li>reference : http://blog.redrocket.club/2018/02/04/Codegate-2018-Preliminary-RedVelvet/</li>
</ul>

<p>íŒ€ì›ì´ ë§¨ì²˜ìŒ Binaryë¥¼ ë´¤ì„ ë•Œ, Angrë¡œ í•´ê²°í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤ê³  í–ˆì—ˆëŠ”ë° Angrë¡œë„ ì—­ì‹œ í•´ë‹¹ ë¬¸ì œë¥¼ í’€ì´í•  ìˆ˜ ìˆì—ˆë‹¤. Find address, Avoid address ì ì ˆíˆ ì°¾ì•„ ë°°ì¹˜í•˜ê³  ëŒë¦¬ë©´ ì •ë‹µì´ íŠ€ì–´ë‚˜ì˜¤ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆì—ˆëŠ”ë°, AngrëŠ” í•­ìƒ ë‚´ê°€ ì§œë©´ posix dumpì—ì„œ Not foundê°€ ëœ¬ë‹¤;;;  ì°¨ì´ì ì„ ë³´ë‹ˆ, printable ë²”ìœ„ë¥¼ ì§€ì •í•´ì¤€ ê²ƒ. simulator ì„¤ì •í•´ì¤€ ê²ƒ ë“± ì—¬ëŸ¬ ì°¨ì´ì ì´ ìˆì—ˆë‹¤.. ë‹¨ìˆœí•˜ê²Œ find, avoid address ë§Œ ì§€ì •í•´ì£¼ëŠ” ë°©ì‹ìœ¼ë¡œëŠ” í•´ê²°ì´ ë˜ì§€ ì•ŠëŠ”ë‹¤;; angr ì—°ìŠµì´ í•„ìš”í•  ë“¯..</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">angr</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">angr</span><span class="p">.</span><span class="n">Project</span><span class="p">(</span><span class="s">'./RedVelvet'</span><span class="p">,</span> <span class="n">load_options</span><span class="o">=</span><span class="p">{</span><span class="s">"auto_load_libs"</span><span class="p">:</span> <span class="bp">False</span><span class="p">})</span>

<span class="n">st</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">factory</span><span class="p">.</span><span class="n">entry_state</span><span class="p">()</span>

<span class="c1"># in printable range
</span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">26</span><span class="p">):</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">st</span><span class="p">.</span><span class="n">posix</span><span class="p">.</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">read_from</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">st</span><span class="p">.</span><span class="n">solver</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">k</span> <span class="o">&gt;=</span> <span class="mh">0x20</span><span class="p">)</span>
    <span class="n">st</span><span class="p">.</span><span class="n">solver</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">k</span> <span class="o">&lt;=</span> <span class="mh">0x7e</span><span class="p">)</span>

<span class="c1"># Constrain the last byte to be a newline
</span><span class="n">k</span> <span class="o">=</span> <span class="n">st</span><span class="p">.</span><span class="n">posix</span><span class="p">.</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">read_from</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">st</span><span class="p">.</span><span class="n">solver</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">k</span> <span class="o">==</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># Reset the symbolic stdin's properties and set its length.
</span><span class="n">st</span><span class="p">.</span><span class="n">posix</span><span class="p">.</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">st</span><span class="p">.</span><span class="n">posix</span><span class="p">.</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">length</span> <span class="o">=</span> <span class="mi">27</span>

<span class="n">sm</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">factory</span><span class="p">.</span><span class="n">simulation_manager</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
<span class="n">sm</span><span class="p">.</span><span class="n">explore</span><span class="p">(</span><span class="n">avoid</span><span class="o">=</span><span class="mh">0x004007d0</span><span class="p">,</span> <span class="n">find</span><span class="o">=</span><span class="mh">0x0040152d</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">sm</span><span class="p">.</span><span class="n">found</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">posix</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> âš¡ root@RebForPwn î‚° ~/jsh î‚° python ./solver.py
WARNING | 2018-02-06 19:00:44,933 | angr.engines.successors | Exit state has over 257 possible solutions. Likely unconstrained<span class="p">;</span> skipping. &lt;BV64 reg_28_31_64&gt;
What_You_Wanna_Be?:<span class="o">)</span>_lc_la
</code></pre></div></div>

<p><br /></p>
<h2 id="solution3---angryida">Solution3 - AngryIDA</h2>
<ul>
  <li>install reference : https://github.com/jinsoohyun/AngryIDA</li>
</ul>

<p><code class="highlighter-rouge">AngryIDA</code>ë¼ëŠ” IDA Pluginì„ ì´ìš©í•œ í’€ì´ ë°©ì‹ì¸ë°, Angrê°€ ì„¤ì¹˜ëœ x64 Windows í™˜ê²½ì—ì„œ IDA Pluginìœ¼ë¡œ Angrë¥¼ ë°”ë¡œ ì´ìš©í•  ìˆ˜ ìˆëŠ” ë°©ì‹ì´ë‹¤. ì–¼í• ë³´ë©´ <code class="highlighter-rouge">Ponce</code>ë‘ ìœ ì‚¬í•œ ëŠë‚Œ.. ì•„ë˜ ì²˜ëŸ¼ avoid, find offsetì„ ì§ì ‘ ì§€ì •í•´ì£¼ê³ , explorer ì—ì„œ runë§Œ ëˆŒëŸ¬ì£¼ë©´ stdinì— ëŒ€í•œ ê°’ì„ ì°¾ì•„ë‚´ëŠ” ê±¸ í™•ì¸í•  ìˆ˜ ìˆë‹¤. (angr ë™ì‘ì´ë‘ ë™ì¼í•˜ë‹¤, ë‹¨ì§€ IDA ì—ì„œ ìˆ˜í–‰ë  ë¿..)</p>

<p><img src="/assets/images/2018-02-06-Codegate-CTF-RedVelvet-75/angryIDA.png" alt="" /></p>
<p align="center"><i>[ê·¸ë¦¼] angryIDA</i></p>

<p><br /></p>
<h2 id="etc---radare2">ETC - Radare2</h2>

<ul>
  <li>í’€ì´ ì˜¬ë¼ì˜¨ ê±¸ ë³´ë‹¤ë³´ë‹ˆ, Radare2ë¥¼ ì´ìš©í•´ binary ë¶„ì„ì„ í•œ ì™¸ì¿¡ì¸ë„ ìˆì—ˆë‹¤. ì˜ˆì „ì— ì¢€ ì‚´í´ë³´ê³  IDA ì— ë¹„í•´ ì˜ ë¶ˆí¸í•´ì„œ ì•ˆì“°ê³  ì‚´ì•˜ëŠ”ë° í’€ì–´ë³´ëŠ” ê³¼ì •ì„ ë³´ë‹ˆ ì—­ì‹œ, ì¥ì¸ì€ ë„êµ¬ë¥¼ íƒ“í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ë§ì´ ë§ëŠ”ê²ƒ ê°™ë‹¤ ã…‹ã…‹..</li>
</ul>

<p align="right"><strong>FLAG{What_You_Wanna_By?:);la_la}</strong></p>
:ET